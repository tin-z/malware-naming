import json

dirs = "./jsons"

vendor_j = "{}/vendor.json".format(dirs)
vendor_k = "Vendor,Id-regex".split(",")
vendor = [  ["K7AntiVirus",[0]] ,\
                    ["K7GW",[0]] ,\
                 ["FireEye",[1,2]] ,\
        ["MicroWorld-eScan",[1,2]] ,\
                   ["ALYac",[1,2]] ,\
             ["BitDefender",[1,2]] ,\
                ["Ad-Aware",[1,2]] ,\
                   ["Cyren",[3]] ,\
                 ["ViRobot",[4]] ,\
                ["F-Secure",[5]] ,\
               ["Microsoft",[7]] ,\
                 ["Arcabit",[8,9]] ,\
                ["AegisLab",[10]] ,\
                   ["Avast",[11,12]] ,\
                     ["AVG",[11,12]] ,\
               ["Kaspersky",[13,14,15]] ,\
               ["ZoneAlarm",[13,14,15]] ,\
               ["AhnLab-V3",[16]] ,\
                ["Fortinet",[17]] ,\
               ["Qihoo-360",[18]] ,\
                   ["Avira",[19]] ,\
                   ["GData",[20,21]] ,\
              ["TrendMicro",[22,23,24]] ,\
    ["TrendMicro-HouseCall",[22,23,24]] ]

regex_j = "{}/regex.json".format(dirs)
regex_k = "id,compose,example,regex".split(",")
regex = [    [0,"MT ( VC )"           ,"Trojan ( 0054ee651 )"                                       ,"(.*) \( ([0-9A-f]{1,}) \)"] ,\
             [1,"MT.MT.MF.VC"         ,"Trojan.Ransomware.GenericKDS.32046564"                      ,"(.*)\.(.*)\.(.*)\.(\w{1,})"] ,\
             [2,"MT.MF.VC"            ,"Trojan.GenericKDS.32046564"                                 ,"(.*)\.(.*)\.(\w{1,})"] ,\
             [3,"P/MT.MF-VC"          ,"W32/Trojan.VIVX-3268"                                       ,"(.*)\/(.*)\.(.*)\-(\w{1,})"] ,\
             [4,"MT.P.MT.VC"          ,"Trojan.Win32.Nemty.197088"                                  ,"(.*)\.(.*)\.(.*)\.(.*)$"] ,\
             [5,"MT.MT/MF.VC"         ,"Trojan.TR/Zudochka.ambvh"                                   ,"(.*)\.(.*)\/(.*)\.(.*)"] ,\
             [7,"MT:P/MF.VC"          ,"Trojan:Win32/Occamy.C"                                      ,"(.*)\:(.*)\/(.*)\.(.*)"] ,\
             [8,"MT.MT.MT.VC"         ,"Trojan.Ransomware.GenericS.D1E8FDE4"                        ,"(.*)\.(.*)\.(.*)\.(.*)"] ,\
             [9,"MT.MT.VC"            ,"Trojan.Generic.D1E8FDE4"                                    ,"(.*)\.(.*)\.(.*)"] ,\
             [10,"MT.P.MF.INF"        ,"Trojan.MSIL.Noon.gen"                                       ,"(.*)\.(.*)\.(.*)\.(.*)"] ,\
             [11,"P:MF [MT]"          ,"Win32:DangerousSig [Trj]"                                   ,"(.*)\:(.*) \[(.*)\]"] ,\
             [12,"P:MF"               ,"Win32:Trojan-gen"                                           ,"(.*)\:(.*)"] ,\
             [13,"INF:MT.P.MF.VC"     ,"HEUR:Trojan-Spy.MSIL.Noon.gen"                              ,"(.*)\:(.*)\.(.*)\.(.*)\.(.*)"] ,\
             [14,"MT.P.MF.VC"         ,"Trojan-Spy.MSIL.Noon.gen"                                   ,"(.*)\.(.*)\.(.*)\.(.*)"] ,\
             [15,"MT.P.MF"            ,"Trojan-Spy.MSIL.Noon"                                       ,"(.*)\.(.*)\.(.*)"] ,\
             [16,"MT/P.MF.VC"         ,"Trojan/Win32.Kryptik.C3289665"                              ,"(.*)\/(.*)\.(.*)\.(.*)"] ,\
             [17,"P/MF.VC"            ,"MSIL/Kryptik.RTU!tr"                                        ,"(.*)\/(.*)\.(.*)"] ,\
             [18,"P/MT.VC"            ,"Win32/Trojan.Spy.beb"                                       ,"(.*)\/(.*)\.(.*)"] ,\
             [19,"MT/MF.VC"           ,"TR/Zudochka.ambvh"                                          ,"(.*)\/(.*)\.(.*)"] ,\
             [20,"P.MT.MF.VC"         ,"Win32.Trojan-Ransom.Nefilim.A"                              ,"(.*)\.(.*)\.(.*)\.(.*)"] ,\
             [21,"P.MT.MF"            ,"MSIL.Packed.Skaldring"                                      ,"(.*)\.(.*)\.(.*)"] ,\
             [22,"MT.P.MF.VC"         ,"Ransom.Win32.NEFILIM.A"                                     ,"(.*)\.(.*)\.(.*)\.(.*)"] ,\
             [23,"MT.P.MF"            ,"Ransom.Win32.NEFILIM"                                       ,"(.*)\.(.*)\.(.*)"] ,\
             [24,"MT_MT.VC"           ,"TROJ_GEN.R002C0WFC19"                                       ,"(.*)_(.*)\.(.*)"] ]


def vendor_recompile() :
  output = []
  with open(vendor_j, "w") as fp:
    for elem in vendor :
      output.append( { vendor_k[idx]:x for idx,x in enumerate(elem) } )
    json.dump(output, fp)


def regex_recompile() :
  output = []
  with open(regex_j, "w") as fp :
    for elem in regex :
      output.append( { regex_k[idx]:x for idx,x in enumerate(elem) } )
    json.dump(output, fp)

vendor_recompile()
regex_recompile()
