#!/usr/bin/env python3
import re
import json
import sys

Verbose = False
for i in sys.argv :
  if "-v" in i :
    Verbose = True


dirs = "./jsons"
fp = open("%s/vendor.json" % dirs, "r")
fp_regex = open("%s/regex.json" % dirs, "r")
naming = json.load(fp)
regex = json.load(fp_regex)
fp.close()
fp_regex.close()


for vendor in naming :
  present = False
   
  id_regex_s = vendor['Id-regex']
  for id_regex in id_regex_s :

    for idx,reg in enumerate(regex) :
      if id_regex == reg['id'] :
        present = True
        break
    
    if present :
      rets=re.findall(regex[idx]['regex'], regex[idx]['example'])
      if rets :
        print("[+] {} - regex matched".format(vendor['Vendor']))
      else :
        print("[x] {} - regex Not matched".format(vendor['Vendor']))
      if Verbose:
        print("  |id:{}, |regex:{} |example:{} |result:{}\n".format(idx, regex[idx]['regex'], regex[idx]['example'], rets))


    else :
      print("[x] {} - does not have an entry".format(vendor['Vendor']))




